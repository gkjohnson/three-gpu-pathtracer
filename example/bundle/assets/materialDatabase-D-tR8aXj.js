import"./modulepreload-polyfill-B5Qt9EMX.js";import{at as b,aI as C,av as y,m as R}from"./MaterialBase-byhyp4gt.js";import{O as I}from"./OrbitControls-BDTesZS8.js";import{g as x}from"./lil-gui.module.min-BH_YJbPT.js";import{L as E}from"./LoaderElement-kg8-0xPv.js";import{g as L}from"./getScaledSettings-nzgggDDj.js";import{R as M,M as P}from"./RectAreaLightUniformsLib-CJR3JT3H.js";import{W as T}from"./WebGLPathTracer-DzRjmE4y.js";import"./GLTFLoader-BYq4k_JA.js";import"./BufferGeometryUtils-DMgFFDwZ.js";import"./pcg.glsl-Dh-2-BlJ.js";import"./PathTracingRenderer-N-9Lxrjr.js";import"./ggx_functions.glsl-BPuHaSoe.js";const k="https://api.physicallybased.info/materials",D='Materials courtesy of "physicallybased.info"</br>Material orb model courtesy of USD Working Group';let t,o,m,g,i,c,p,l,f;const s={material:null,tiles:2,bounces:5,multipleImportanceSampling:!0,renderScale:1/window.devicePixelRatio,...L()};F();async function F(){M.init(),l=new E,l.attach(document.body),f=document.getElementById("materialImage"),o=new b({antialias:!0}),o.toneMapping=C,o.toneMappingExposure=.02,document.body.appendChild(o.domElement),t=new T(o),t.multipleImportanceSampling=s.multipleImportanceSampling,t.tiles.set(s.tiles,s.tiles),t.textureSize.set(2048,2048),t.filterGlossyFactor=.5,p=new y;const[n,e]=await Promise.all([new P().loadAsync(),fetch(k).then(r=>r.json())]);p.add(n.scene),i=n.camera,g=n.material,p.attach(i),i.removeFromParent(),m=new I(i,o.domElement),m.addEventListener("change",()=>t.updateCamera());const S=new R(0,0,-1).transformDirection(i.matrixWorld).normalize();m.target.copy(i.position).addScaledVector(S,25),m.update(),c={},e.forEach(r=>c[r.name]=r),s.material=Object.keys(c)[0],t.setScene(p,i),l.setPercentage(1),l.setCredits(D),a(),h(),window.addEventListener("resize",h);const u=new x;u.add(s,"material",Object.keys(c)).onChange(a);const d=u.addFolder("Path Tracing");d.add(s,"multipleImportanceSampling").onChange(a),d.add(s,"tiles",1,4,1).onChange(r=>{t.tiles.set(r,r)}),d.add(s,"bounces",1,30,1).onChange(a),d.add(s,"renderScale",.1,1).onChange(a),w()}function h(){o.setSize(window.innerWidth,window.innerHeight),o.setPixelRatio(window.devicePixelRatio),i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),t.updateCamera()}function G(n,e){e.color.set(16777215),e.transmission=0,e.attenuationDistance=1,e.attenuationColor.set(16777215),e.specularColor.set(16777215),e.metalness=0,e.roughness=1,e.ior=1.5,e.thickness=1,e.iridescence=0,e.iridescenceIOR=1,e.iridescenceThicknessRange=[0,0],n.specularColor&&e.specularColor.setRGB(...n.specularColor),"metalness"in n&&(e.metalness=n.metalness),"roughness"in n&&(e.roughness=n.roughness),"ior"in n&&(e.ior=n.ior),"transmission"in n&&(e.transmission=n.transmission),"thinFilmThickness"in n&&(e.iridescence=1,e.iridescenceIOR=n.thinFilmIor,e.iridescenceThicknessRange=[n.thinFilmThickness,n.thinFilmThickness]),e.transmission?(n.color&&e.attenuationColor.setRGB(...n.color),n.transmissionDepth?e.attenuationDistance=n.transmissionDepth:e.attenuationDistance=1):n.color&&e.color.setRGB(...n.color),f.src=n.reference[0]}function a(){G(c[s.material],g),t.multipleImportanceSampling=s.multipleImportanceSampling,t.renderScale=s.renderScale,t.bounces=s.bounces,t.updateMaterials()}function w(){requestAnimationFrame(w),t.renderSample(),l.setSamples(t.samples,t.isCompiling)}
