import"./modulepreload-polyfill-B5Qt9EMX.js";import{at as y,au as E,av as L,a1 as D,aM as k,X as T,aF as v,M as A,aN as N}from"./MaterialBase-byhyp4gt.js";import{G as F}from"./GLTFLoader-BYq4k_JA.js";import{O as G}from"./OrbitControls-BDTesZS8.js";import{H}from"./HDRLoader-uXUM045B.js";import{M as I}from"./meshopt_decoder.module-j6OW_3Rk.js";import{g as W}from"./lil-gui.module.min-BH_YJbPT.js";import{g as _}from"./__vite-browser-external-C8XJ56jx.js";import{g as j}from"./getScaledSettings-nzgggDDj.js";import{L as O}from"./LoaderElement-kg8-0xPv.js";import{W as U}from"./WebGLPathTracer-DzRjmE4y.js";import{B as z}from"./BlurredEnvMapGenerator-BhQfzXaX.js";import"./BufferGeometryUtils-DMgFFDwZ.js";import"./pcg.glsl-Dh-2-BlJ.js";import"./PathTracingRenderer-N-9Lxrjr.js";import"./ggx_functions.glsl-BPuHaSoe.js";const B="https://raw.githubusercontent.com/gkjohnson/3d-demo-data/master/hdri/aristea_wreck_puresky_2k.hdr",q="https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/models/gltf/RobotExpressive/RobotExpressive.glb",K="https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/trex/scene.gltf",V="Model by DailyArt on Sketchfab",X="Rendering deformable geometry with path tracing.";let t,a,m,n,r,S,g,p,d,l=0;const e={bounces:5,samplesPerFrame:1,renderScale:1/window.devicePixelRatio,tiles:1,autoPause:!0,pause:!1,continuous:!1,stableNoise:!1,...j()};J();async function J(){d=new O,d.setDescription(X),d.attach(document.body),a=new y({antialias:!0}),a.toneMapping=E,document.body.appendChild(a.domElement),t=new U(a),t.multipleImportanceSampling=!1,t.tiles.set(e.tiles,e.tiles),t.filterGlossyFactor=.25,t.minSamples=1,t.renderDelay=0,t.fadeDuration=0,r=new L,n=new D(75,window.innerWidth/window.innerHeight,.025,500),n.position.set(5.5,3.5,7.5),m=new G(n,a.domElement),n.lookAt(m.target),m.addEventListener("change",()=>t.updateCamera()),m.update(),S=new N;const o=window.location.hash==="#morphtarget"?q:K,[x,u]=await Promise.all([new H().loadAsync(B),new F().setMeshoptDecoder(I).loadAsync(o)]),h=new z(a),f=h.generate(x,.1);r.background=f,r.environment=f,h.dispose();const M=u.animations;g=new k(u.scene),p=g.clipAction(M[0]),p.play(),p.paused=e.pause,r.add(u.scene);const R=_(2048),c=new T(new v,new A({map:R,transparent:!0,color:14540253,roughness:.15,metalness:1}));c.scale.setScalar(50),c.rotation.x=-Math.PI/2,c.position.y=.075,r.add(c),t.setScene(r,n),d.setPercentage(1),d.setCredits(V),b(),window.addEventListener("resize",b);const i=new W;i.add(e,"tiles",1,4,1).onChange(s=>{t.tiles.set(s,s)}),i.add(e,"bounces",1,10,1).onChange(w),i.add(e,"renderScale",.1,1).onChange(s=>{t.renderScale=s,t.reset()}),i.add(e,"autoPause").listen(),i.add(e,"pause").onChange(s=>{e.autoPause=!1,P(s)}).listen(),i.add(e,"continuous").onChange(()=>{e.autoPause=!1}),i.add(e,"stableNoise").onChange(s=>{t.stableNoise=s}),C()}function P(o){p.paused=o,e.pause=o,o&&w()}function b(){a.setSize(window.innerWidth,window.innerHeight),a.setPixelRatio(window.devicePixelRatio),n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),t.updateCamera()}function w(){t.bounces=e.bounces,t.setScene(r,n)}function C(){requestAnimationFrame(C);const o=Math.min(S.getDelta(),30*.001);g.update(o),e.autoPause?(l+=o,(!e.pause&&l>=2.5||e.pause&&l>=5)&&(P(!e.pause),l=0)):l=0,t.dynamicLowRes=e.continuous,!e.pause&&!e.continuous?(a.render(r,n),d.setSamples(0,t.isCompiling)):(!e.pause&&e.continuous&&w(),t.renderSample(),d.setSamples(t.samples,t.isCompiling))}
